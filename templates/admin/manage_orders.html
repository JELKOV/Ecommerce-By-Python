{% extends "base/layout.html" %}

{% block title %}ğŸ“¦ ì£¼ë¬¸ ê´€ë¦¬{% endblock %}

{% block content %}
<div class="container py-5">
    <h3 class="text-center mb-4">ğŸ“¦ ì£¼ë¬¸ ê´€ë¦¬</h3>

    <!-- í•„í„° ë° ì •ë ¬ ì„ íƒ ì˜ì—­ -->
    <div class="row justify-content-center">
        <div class="col-md-3">
            <label>ì´ ê°€ê²© ì •ë ¬</label>
            <select id="sort-price" class="form-select">
                <option value="desc" {% if request.args.get('sort_price') == 'desc' %}selected{% endif %}>ë†’ì€ ê°€ê²©ìˆœ</option>
                <option value="asc" {% if request.args.get('sort_price') == 'asc' %}selected{% endif %}>ë‚®ì€ ê°€ê²©ìˆœ</option>
            </select>
        </div>
        <div class="col-md-4">
            <label>ê²°ì œ ìƒíƒœ</label>
            <select id="filter-status" class="form-select">
                <option value="">ì „ì²´ ìƒíƒœ</option>
                <option value="pending" {% if request.args.get('payment_status') == 'pending' %}selected{% endif %}>ëŒ€ê¸°</option>
                <option value="paid" {% if request.args.get('payment_status') == 'paid' %}selected{% endif %}>ê²°ì œ ì™„ë£Œ</option>
                <option value="failed" {% if request.args.get('payment_status') == 'failed' %}selected{% endif %}>ê²°ì œ ì‹¤íŒ¨</option>
            </select>
        </div>
        <div class="col-md-4">
            <label>ê²°ì œ ë°©ë²• í•„í„°ë§</label>
            <select id="filter-method" class="form-select">
                <option value="">ì „ì²´ ê²°ì œë°©ë²•</option>
                <option value="direct" {% if request.args.get('payment_method') == 'direct' %}selected{% endif %}>ë°”ë¡œ êµ¬ë§¤</option>
                <option value="cart" {% if request.args.get('payment_method') == 'cart' %}selected{% endif %}>ì¥ë°”êµ¬ë‹ˆ</option>
            </select>
        </div>
    </div>

    <table class="table table-hover shadow mt-4">
        <thead class="table-dark">
            <tr>
                <th>ì£¼ë¬¸ ID</th>
                <th>ì‚¬ìš©ì ID</th>
                <th>ì£¼ë¬¸ ìƒí’ˆ</th>
                <th>ì´ ê°€ê²©</th>
                <th>ê²°ì œ ìƒíƒœ</th>
                <th>ê²°ì œ ë°©ë²•</th>
                <th>ì£¼ë¬¸ ì¼ì</th>
            </tr>
        </thead>
        <tbody>
        {% for order in orders %}
            <tr>
                <td>{{ order.order_id }}</td>
                <td>{{ order.user.username }}</td>
                <td>{{ order.order_name or 'ì •ë³´ ì—†ìŒ' }}</td>
                <td>{{ order.total_price | int }}ì›</td>
                <td>
                    <select class="form-select order-status-select" data-order-id="{{ order.order_id }}">
                        <option value="pending" {% if order.payment_status == 'pending' %}selected{% endif %}>ëŒ€ê¸°</option>
                        <option value="paid" {% if order.payment_status == 'paid' %}selected{% endif %}>ê²°ì œ ì™„ë£Œ</option>
                        <option value="failed" {% if order.payment_status == 'failed' %}selected{% endif %}>ê²°ì œ ì‹¤íŒ¨</option>
                    </select>
                </td>
                <td>{{ order.payment_method }}</td>
                <td>{{ order.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>

<script src="{{ url_for('static', filename='js/orders.js') }}"></script>
{% endblock %}
