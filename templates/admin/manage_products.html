{% extends "base/layout.html" %}

{% block content %}
<h1>상품 관리</h1>

<!-- ✅ 상품 검색 및 API 호출 -->
<div>
    <input type="text" id="query" placeholder="검색어 입력">
    <button onclick="fetchProducts()">API에서 상품 가져오기</button>
</div>

<table>
    <thead>
        <tr>
            <th>상품명</th>
            <th>가격</th>
            <th>수정</th>
            <th>삭제</th>
        </tr>
    </thead>
    <tbody id="product-list">
        {% for product in products.items %}
        <tr>
            <td>{{ product.name }}</td>
            <td>{{ product.price|int }}원</td>
            <td><a href="{{ url_for('admin_routes.edit_product', product_id=product.id) }}">수정</a></td>
            <td>
                <form action="{{ url_for('admin_routes.delete_product', product_id=product.id) }}" method="POST">
                    <button type="submit" onclick="return confirm('정말 삭제하시겠습니까?')">삭제</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- ✅ 페이징 처리 -->
<div>
    {% if products.has_prev %}
        <a href="{{ url_for('admin_routes.manage_products', page=products.prev_num) }}">이전</a>
    {% endif %}
    <span>페이지 {{ products.page }} / {{ products.pages }}</span>
    {% if products.has_next %}
        <a href="{{ url_for('admin_routes.manage_products', page=products.next_num) }}">다음</a>
    {% endif %}
</div>
{% endblock %}

{% block scripts %}
    <script src="{{ url_for('static', filename='js/admin.js') }}"></script>
{% endblock %}
