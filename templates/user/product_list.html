{% extends "base/layout.html" %}

{% block title %}상품 목록 - My Shop{% endblock %}

{% block content %}
    <h1>상품 목록</h1>

    <!-- 🔹 검색 및 필터링 폼 -->
    <form action="{{ url_for('product_routes.product_list') }}" method="GET">
        <input type="text" name="query" placeholder="검색어 입력" value="{{ query }}">
        <input type="number" name="min_price" placeholder="최소 가격" value="{{ min_price or '' }}">
        <input type="number" name="max_price" placeholder="최대 가격" value="{{ max_price or '' }}">

        <select name="sort_by">
            <option value="latest" {% if sort_by == 'latest' %}selected{% endif %}>최신순</option>
            <option value="price_asc" {% if sort_by == 'price_asc' %}selected{% endif %}>가격 낮은 순</option>
            <option value="price_desc" {% if sort_by == 'price_desc' %}selected{% endif %}>가격 높은 순</option>
        </select>

        <button type="submit">검색</button>
    </form>

    <!-- 🔹 상품 목록 -->
    <div id="product-list">
        {% for product in products.items %}
            <div class="product-item">
                <h2>{{ product.name }}</h2>
                <p>{{ product.description }}</p>
                <p>가격: {{ product.price }}원</p>
                <img src="{{ product.image_url }}" width="150" alt="상품 이미지">
                <a href="{{ url_for('product_routes.product_detail', product_id=product.id) }}">상세보기</a>
            </div>
        {% endfor %}
    </div>

    <!-- 🔹 페이징 -->
    <div class="pagination">
        {% if products.has_prev %}
            <a href="{{ url_for('product_routes.product_list', page=products.prev_num, query=query, min_price=min_price, max_price=max_price, sort_by=sort_by) }}">이전</a>
        {% endif %}

        <span>{{ products.page }} / {{ products.pages }}</span>

        {% if products.has_next %}
            <a href="{{ url_for('product_routes.product_list', page=products.next_num, query=query, min_price=min_price, max_price=max_price, sort_by=sort_by) }}">다음</a>
        {% endif %}
    </div>
{% endblock %}
