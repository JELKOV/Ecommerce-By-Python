{% extends "base/layout.html" %}

{% block title %}ìƒí’ˆ ëª©ë¡ - My Shop{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1 class="text-center mb-4">ğŸ›’ ìƒí’ˆ ëª©ë¡</h1>

    <!-- ğŸ”¹ ê²€ìƒ‰ ë° í•„í„°ë§ í¼ -->
    <form action="{{ url_for('product_routes.product_list') }}" method="GET" class="d-flex flex-wrap justify-content-center gap-2 mb-4">
        <input type="text" name="query" class="form-control w-auto" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥" value="{{ query }}">
        <input type="number" name="min_price" class="form-control w-auto" placeholder="ìµœì†Œ ê°€ê²©" value="{{ min_price or '' }}">
        <input type="number" name="max_price" class="form-control w-auto" placeholder="ìµœëŒ€ ê°€ê²©" value="{{ max_price or '' }}">

        <!-- ğŸ”¹ ì¹´í…Œê³ ë¦¬ ì„ íƒ ë“œë¡­ë‹¤ìš´ (DBì—ì„œ ë™ì ìœ¼ë¡œ ê°€ì ¸ì˜´) -->
        <select name="category" class="form-select w-auto">
            {% for cat in categories %}
                <option value="{{ cat }}" {% if category == cat %}selected{% endif %}>{{ cat }}</option>
            {% endfor %}
        </select>

        <!-- ğŸ”¹ ì •ë ¬ ì„ íƒ -->
        <select name="sort_by" class="form-select w-auto">
            <option value="latest" {% if sort_by == 'latest' %}selected{% endif %}>ìµœì‹ ìˆœ</option>
            <option value="price_asc" {% if sort_by == 'price_asc' %}selected{% endif %}>ê°€ê²© ë‚®ì€ ìˆœ</option>
            <option value="price_desc" {% if sort_by == 'price_desc' %}selected{% endif %}>ê°€ê²© ë†’ì€ ìˆœ</option>
        </select>

        <button type="submit" class="btn btn-primary">ê²€ìƒ‰</button>
    </form>

    <!-- ğŸ”¹ ìƒí’ˆ ëª©ë¡ (ì¹´ë“œí˜• UI) -->
    <div class="row">
        {% for product in products.items %}
        <div class="col-md-4 mb-4">
            <div class="card shadow-sm">
                <img src="{{ product.image_url }}" class="card-img-top" alt="ìƒí’ˆ ì´ë¯¸ì§€">
                <div class="card-body text-center">
                    <h5 class="card-title">{{ product.name }}</h5>
                    <p class="card-text text-muted">{{ product.description }}</p>
                    <p class="card-text fw-bold">ğŸ’° {{ product.price|int }}ì›</p>
                    <a href="{{ url_for('product_routes.product_detail', product_id=product.id) }}" class="btn btn-outline-primary">ìƒì„¸ë³´ê¸°</a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- ğŸ”¹ í˜ì´ì§• -->
    <div class="d-flex justify-content-center mt-4">
        {% if products.has_prev %}
            <a href="{{ url_for('product_routes.product_list', page=products.prev_num, query=query, min_price=min_price, max_price=max_price, category=category, sort_by=sort_by) }}" class="btn btn-outline-secondary mx-2">ì´ì „</a>
        {% endif %}

        <span class="align-self-center fw-bold">{{ products.page }} / {{ products.pages }}</span>

        {% if products.has_next %}
            <a href="{{ url_for('product_routes.product_list', page=products.next_num, query=query, min_price=min_price, max_price=max_price, category=category, sort_by=sort_by) }}" class="btn btn-outline-secondary mx-2">ë‹¤ìŒ</a>
        {% endif %}
    </div>
</div>
{% endblock %}
